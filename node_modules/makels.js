require("prelude-ls").installPrelude(global);
require("viclib")();
(function(){
  var viclib, fs, exec, file, minify;
  viclib = require('viclib').install();
  fs = require('fs');
  exec = require('child_process').exec;
  file = process.argv[2] ? process.argv[2] : "/Users/vhsmaia/Viclib/node_modules/test.ls";
  minify = false;
  if (file != null && file.indexOf('.ls') !== -1) {
    file = file.replace('.ls', "");
    log("LiveScript + Viclib compiler: ");
    log(file + ".ls");
    exec("node node_modules/livescript/bin/livescript -cp " + file + '.ls', function(err, js, stderr){
      if (stderr) {
        log(stderr);
        process.exit();
      }
      js = 'require("prelude-ls").installPrelude(global);\n' + (file.slice(file.length - 6) !== "viclib" ? 'require("viclib")();\n' : '') + js;
      fs.writeFileSync(file + '.js', js);
      log(file + ".js");
      if (file.indexOf("index") !== -1) {
        return exec('(echo <html><body><script> && node node_modules/browserify/bin/cmd.js --ig ' + file + '.js && echo </script></body></html>) > ' + file + '.html', function(err, stdout, stderr){
          if (stderr != null) {
            log(stderr);
          }
          log(file + ".html");
          return fs.unlink(file + ".js");
        });
      }
    });
  }
}).call(this);
